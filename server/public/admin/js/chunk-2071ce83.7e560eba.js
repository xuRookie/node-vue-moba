(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2071ce83"],{1774:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"hero-create"},[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v(e._s(e.id?"编辑":"新增")+"英雄")]),e.id?r("el-button",{staticClass:"btn-back",attrs:{type:"text"},on:{click:e.handleBack}},[e._v("返回")]):e._e()],1),r("el-form",{ref:"heroForm",attrs:{model:e.heroForm,"label-width":"88px"},nativeOn:{submit:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[r("el-tabs",{attrs:{type:"border-card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"基础信息",name:"basic"}},[r("el-form-item",{attrs:{label:"名称",prop:"name"}},[r("el-input",{model:{value:e.heroForm.name,callback:function(t){e.$set(e.heroForm,"name",t)},expression:"heroForm.name"}})],1),r("el-form-item",{attrs:{label:"头像",prop:"avatar"}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.uploadUrl,"show-file-list":!1,headers:e.getAuthorization(),"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.heroForm.avatar?r("img",{staticClass:"avatar",attrs:{src:e.heroForm.avatar}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),r("el-form-item",{attrs:{label:"封面",prop:"banner"}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.uploadUrl,"show-file-list":!1,headers:e.getAuthorization(),"on-success":function(t){return e.$set(e.heroForm,"banner",t.url)},"before-upload":e.beforeAvatarUpload}},[e.heroForm.banner?r("img",{staticClass:"avatar",attrs:{src:e.heroForm.banner}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),r("el-form-item",{attrs:{label:"称号",prop:"title"}},[r("el-input",{model:{value:e.heroForm.title,callback:function(t){e.$set(e.heroForm,"title",t)},expression:"heroForm.title"}})],1),r("el-form-item",{attrs:{label:"类型"}},[r("el-select",{staticClass:"select-width",attrs:{multiple:""},model:{value:e.heroForm.categories,callback:function(t){e.$set(e.heroForm,"categories",t)},expression:"heroForm.categories"}},e._l(e.categories,(function(e){return r("el-option",{key:e._id,attrs:{label:e.name,value:e._id}})})),1)],1),r("el-form-item",{attrs:{label:"难度"}},[r("el-rate",{staticClass:"hero-rate",attrs:{max:10,"show-score":""},model:{value:e.heroForm.scores.difficult,callback:function(t){e.$set(e.heroForm.scores,"difficult",t)},expression:"heroForm.scores.difficult"}})],1),r("el-form-item",{attrs:{label:"技能"}},[r("el-rate",{staticClass:"hero-rate",attrs:{max:10,"show-score":""},model:{value:e.heroForm.scores.skills,callback:function(t){e.$set(e.heroForm.scores,"skills",t)},expression:"heroForm.scores.skills"}})],1),r("el-form-item",{attrs:{label:"攻击"}},[r("el-rate",{staticClass:"hero-rate",attrs:{max:10,"show-score":""},model:{value:e.heroForm.scores.attack,callback:function(t){e.$set(e.heroForm.scores,"attack",t)},expression:"heroForm.scores.attack"}})],1),r("el-form-item",{attrs:{label:"生存"}},[r("el-rate",{staticClass:"hero-rate",attrs:{max:10,"show-score":""},model:{value:e.heroForm.scores.survive,callback:function(t){e.$set(e.heroForm.scores,"survive",t)},expression:"heroForm.scores.survive"}})],1),r("el-form-item",{attrs:{label:"顺风出装"}},[r("el-select",{staticClass:"select-width",attrs:{multiple:""},model:{value:e.heroForm.items1,callback:function(t){e.$set(e.heroForm,"items1",t)},expression:"heroForm.items1"}},e._l(e.items,(function(e){return r("el-option",{key:e._id,attrs:{label:e.name,value:e._id}})})),1)],1),r("el-form-item",{attrs:{label:"逆风出装"}},[r("el-select",{staticClass:"select-width",attrs:{multiple:""},model:{value:e.heroForm.items2,callback:function(t){e.$set(e.heroForm,"items2",t)},expression:"heroForm.items2"}},e._l(e.items,(function(e){return r("el-option",{key:e._id,attrs:{label:e.name,value:e._id}})})),1)],1),r("el-form-item",{attrs:{label:"使用技巧"}},[r("el-input",{attrs:{type:"textarea",autosize:{minRows:3}},model:{value:e.heroForm.usageTips,callback:function(t){e.$set(e.heroForm,"usageTips",t)},expression:"heroForm.usageTips"}})],1),r("el-form-item",{attrs:{label:"攻击技巧"}},[r("el-input",{attrs:{type:"textarea",autosize:{minRows:3}},model:{value:e.heroForm.battleTips,callback:function(t){e.$set(e.heroForm,"battleTips",t)},expression:"heroForm.battleTips"}})],1),r("el-form-item",{attrs:{label:"团战思路"}},[r("el-input",{attrs:{type:"textarea",autosize:{minRows:3}},model:{value:e.heroForm.teamTips,callback:function(t){e.$set(e.heroForm,"teamTips",t)},expression:"heroForm.teamTips"}})],1)],1),r("el-tab-pane",{attrs:{label:"技能信息",name:"skills"}},[r("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:e.handleAddSkills}},[e._v("添加技能")]),r("el-row",{staticClass:"mt-2",staticStyle:{"flex-wrap":"wrap"},attrs:{type:"flex"}},e._l(e.heroForm.skills,(function(t,a){return r("el-col",{key:a,staticClass:"b-dashed mb-1",attrs:{span:12}},[r("el-form-item",{attrs:{label:"名称"}},[r("el-input",{model:{value:t.name,callback:function(r){e.$set(t,"name",r)},expression:"item.name"}})],1),r("el-form-item",{attrs:{label:"冷却值"}},[r("el-input",{model:{value:t.delay,callback:function(r){e.$set(t,"delay",r)},expression:"item.delay"}})],1),r("el-form-item",{attrs:{label:"消耗"}},[r("el-input",{model:{value:t.cost,callback:function(r){e.$set(t,"cost",r)},expression:"item.cost"}})],1),r("el-form-item",{attrs:{label:"图标"}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.uploadUrl,"show-file-list":!1,headers:e.getAuthorization(),"on-success":function(r){return e.$set(t,"icon",r.url)},"before-upload":e.beforeAvatarUpload}},[t.icon?r("img",{staticClass:"avatar",attrs:{src:t.icon}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),r("el-form-item",{attrs:{label:"描述"}},[r("el-input",{attrs:{type:"textarea",autosize:{minRows:3}},model:{value:t.description,callback:function(r){e.$set(t,"description",r)},expression:"item.description"}})],1),r("el-form-item",{attrs:{label:"小提示"}},[r("el-input",{attrs:{type:"textarea",autosize:{minRows:3}},model:{value:t.tips,callback:function(r){e.$set(t,"tips",r)},expression:"item.tips"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.handleDeleteSkill(a)}}},[e._v("删除")])],1)],1)})),1)],1),r("el-tab-pane",{attrs:{label:"最佳搭档",name:"partners"}},[r("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:function(t){return e.heroForm.partners.push({})}}},[e._v("添加英雄")]),r("el-row",{staticClass:"mt-2",staticStyle:{"flex-wrap":"wrap"},attrs:{type:"flex"}},e._l(e.heroForm.partners,(function(t,a){return r("el-col",{key:a,staticClass:"b-dashed mb-1",attrs:{span:12}},[r("el-form-item",{attrs:{label:"英雄"}},[r("el-select",{attrs:{filterable:""},model:{value:t.hero,callback:function(r){e.$set(t,"hero",r)},expression:"item.hero"}},e._l(e.heroes,(function(e){return r("el-option",{key:e._id,attrs:{value:e._id,label:e.name}})})),1)],1),r("el-form-item",{attrs:{label:"描述"}},[r("el-input",{attrs:{type:"textarea",autosize:{minRows:3}},model:{value:t.description,callback:function(r){e.$set(t,"description",r)},expression:"item.description"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.handleDeleteHero(a)}}},[e._v("删除")])],1)],1)})),1)],1)],1),r("el-form-item",{staticClass:"mt-2"},[r("el-button",{attrs:{type:"primary","native-type":"submit"}},[e._v("保存")])],1)],1)],1)],1)},s=[],o=(r("a434"),r("96cf"),r("1da1")),l={props:{id:{type:String}},data:function(){return{categories:[],items:[],activeName:"basic",heroes:[],heroForm:{name:"",title:"",banner:"",categories:[],scores:{difficult:0,skills:0,attack:0,survive:0},skills:[],items1:[],items2:[],usageTips:"",battleTips:"",teamTips:"",avatar:"",partners:[]}}},created:function(){this.id&&this.handleGetDetails(),this.handleGetCategory(),this.handleGetItems(),this.handleGetHeroes()},methods:{handleGetDetails:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.get("/rest/heroes/".concat(e.id));case 3:r=t.sent,e.heroForm=Object.assign({},e.heroForm,r),t.next=11;break;case 7:t.prev=7,t.t0=t["catch"](0),a=t.t0.data.message,e.$message.error(a||t.t0.statusText||"英雄详情获取失败");case 11:case"end":return t.stop()}}),t,null,[[0,7]])})))()},handleGetCategory:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.get("/rest/categories");case 3:r=t.sent,e.categories=r,t.next=11;break;case 7:t.prev=7,t.t0=t["catch"](0),a=t.t0.data.message,e.$message.error(a||t.t0.statusText||"英雄分类获取失败");case 11:case"end":return t.stop()}}),t,null,[[0,7]])})))()},handleGetItems:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.get("/rest/items");case 3:r=t.sent,e.items=r,t.next=11;break;case 7:t.prev=7,t.t0=t["catch"](0),a=t.t0.data.message,e.$message.error(a||t.t0.statusText||"物品获取失败");case 11:case"end":return t.stop()}}),t,null,[[0,7]])})))()},handleGetHeroes:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.get("/rest/heroes");case 3:r=t.sent,e.heroes=r,t.next=11;break;case 7:t.prev=7,t.t0=t["catch"](0),a=t.t0.data.message,e.$message.error(a||t.t0.statusText||"英雄获取失败");case 11:case"end":return t.stop()}}),t,null,[[0,7]])})))()},handleAddSkills:function(){this.heroForm.skills.push({})},handleDeleteSkill:function(e){this.heroForm.skills.splice(e,1)},handleDeleteHero:function(e){this.heroForm.partners.splice(e,1)},handleSubmit:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!e.id){t.next=6;break}return t.next=4,e.$http.put("/rest/heroes",e.heroForm);case 4:t.next=8;break;case 6:return t.next=8,e.$http.post("/rest/heroes",e.heroForm);case 8:e.$message.success("保存成功"),e.$router.push("/heroes/list"),t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](0),r=t.t0.data.message,e.$message.error(r||t.t0.statusText||"保存失败");case 16:case"end":return t.stop()}}),t,null,[[0,12]])})))()},handleAvatarSuccess:function(e){this.heroForm.avatar=e.url},beforeAvatarUpload:function(e){var t=/(png|jpg|gif|jpeg|webp)$/,r=e.size/1024/1024<5;return t.test(e.type)?(r||this.$message.error("上传头像图片大小不能超过 5MB!"),r):(this.$message.error("上传图片格式错误！"),!1)},handleBack:function(){this.$router.go(-1)}}},i=l,n=(r("c49c"),r("2877")),c=Object(n["a"])(i,a,s,!1,null,"7b5b4004",null);t["default"]=c.exports},"49c6":function(e,t,r){},c49c:function(e,t,r){"use strict";var a=r("49c6"),s=r.n(a);s.a}}]);